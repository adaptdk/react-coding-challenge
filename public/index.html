<html>
<head>
<script src="https://unpkg.com/react@16/umd/react.development.js"> </script><script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js">
</script>
<script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
<!-- <script type="text/javascript" src="../api.json"></script> -->
</head>
<body>
	yo
    <div id="root"></div>
    <script type="text/babel">
    
    /* 
    ADD REACT CODE HERE 
    */

    class App extends React.Component {	
	    constructor(){
	        super();
	        this.state = {
	            subjects: ["Fiction", "Science"],
	            subject: false,
	            books: [{title: "book1"}, {title: "book2"}]
	        };
	        this.updateSubject = this.updateSubject.bind(this);
	        this.updateBook = this.updateBook.bind(this);
	    }
	    updateSubject(subject) {
		    fetch('subjects')
			    .then((results) => results.json())
		    	.then((data) =>
			        this.setState({
			            subject: subject,
			            subjects: data
			        })
	        	);
	    }
	    updateBook(book) {
		    fetch('books')
			    .then((results) => results.json())
		    	.then((data) =>
			        this.setState({
			        	book: book,
			        	books: data
			        })
	        	);
	    }
	    render() {
	        return <Chooser subjects={this.state.subjects} updateSubject={this.updateSubject} subject={this.state.subject} updateBook={this.updateBook} books={this.state.books} />;
	    }
	}

    class Chooser extends React.Component {	

	    render() {
	        return (
	        	<div>
					{<SubjectChooser subjects={this.props.subjects} updateSubject={this.props.updateSubject} subject={this.props.subject}/>}	
	        		{this.props.subject ? <BookChooser updateBook={this.props.updateBook} books={this.props.books} /> : null}
	        	</div>
	        );
	    }
	}

    class SubjectChooser extends React.Component {	

	    render() {
	    	let updateSubject = this.props.updateSubject;
	    	let buttonsArray = this.props.subjects.map(function(subject, index){
				return <Button label={subject} key={index} updateFn={updateSubject} />;
			});

	        return (
	        	<div>
					<h2>Subjects</h2>
					{buttonsArray} 	
	        	</div>
	        );
	    }
	}

    class BookChooser extends React.Component {	
	    render() {

	    	let updateBook = this.props.updateBook;
	    	let buttons2Array = this.props.books.map(function(book, index){
				return <Button label={book.title} key={index} updateFn={updateBook} />;
			});

	        return (
	        	<div> 
	        		<h2>Books</h2>
	        		{buttons2Array}
	        	</div>
	        )
	    }
	}

    class Button extends React.Component {	
	    render() {
	        return <span onClick={() => this.props.updateFn(this.props.label)}>{this.props.label}</span>;
	    }
	}

   	ReactDOM.render(
   	    <App />,  
   	    document.getElementById("root")
   	);

    
    </script>
</body>
</html>